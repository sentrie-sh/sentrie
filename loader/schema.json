{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://sentrie.dev/schemas/pack-manifest-v1.json",
  "title": "Sentrie Pack Manifest v1",
  "type": "object",
  "properties": {
    "schema": {
      "type": "object",
      "properties": {
        "version": {
          "type": "integer",
          "const": 1
        }
      },
      "required": [
        "version"
      ],
      "additionalProperties": false
    },
    "pack": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "pattern": "^([a-zA-Z][a-zA-Z0-9_-]*)(\\.[a-zA-Z][a-zA-Z0-9_-]*)*$"
        },
        "version": {
          "type": "string",
          "pattern": "^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-[0-9A-Za-z-]+(?:\\.[0-9A-Za-z-]+)*)?(?:\\+[0-9A-Za-z-]+(?:\\.[0-9A-Za-z-]+)*)?$"
        },
        "description": {
          "type": "string"
        },
        "license": {
          "type": "string"
        },
        "repository": {
          "oneOf": [
            {
              "type": "string",
              "format": "uri",
              "minLength": 1
            },
            {
              "type": "string",
              "maxLength": 0
            }
          ]
        },
        "authors": {
          "oneOf": [
            {
              "type": "object",
              "propertyNames": {
                "type": "string",
                "minLength": 1
              },
              "additionalProperties": {
                "type": "string",
                "format": "email"
              }
            },
            {
              "type": "null"
            }
          ]
        }
      },
      "required": [
        "name",
        "version"
      ],
      "additionalProperties": false
    },
    "engine": {
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "sentrie": {
              "type": "string",
              "description": "Semver constraint expression, e.g. \">=0.1.0 <1.0.0\""
            }
          },
          "required": [
            "sentrie"
          ],
          "additionalProperties": false
        },
        {
          "type": "null"
        }
      ]
    },
    "permissions": {
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "fs_read": {
              "oneOf": [
                {
                  "type": "array",
                  "items": {
                    "type": "string"
                  },
                  "uniqueItems": true
                },
                {
                  "type": "null"
                }
              ]
            },
            "net": {
              "oneOf": [
                {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "format": "uri"
                  },
                  "uniqueItems": true
                },
                {
                  "type": "null"
                }
              ]
            },
            "env": {
              "oneOf": [
                {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "pattern": "^[A-Z_][A-Z0-9_]*$"
                  },
                  "uniqueItems": true
                },
                {
                  "type": "null"
                }
              ]
            }
          },
          "additionalProperties": false
        },
        {
          "type": "null"
        }
      ]
    },
    "metadata": {
      "oneOf": [
        {
          "type": "object",
          "description": "Free-form tooling-only metadata, may contain arbitrary keys/values",
          "additionalProperties": true
        },
        {
          "type": "null"
        }
      ]
    }
  },
  "required": [
    "schema",
    "pack"
  ],
  "additionalProperties": false
}